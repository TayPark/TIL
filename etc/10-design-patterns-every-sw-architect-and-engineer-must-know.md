# 소프트웨어 아키텍트와 엔지니어가 꼭 알아야 할 10가지 디자인 패턴

소스: https://ravindraelicherla.medium.com/10-design-patterns-every-software-architect-must-know-b33237bc01c2

디자인 패턴에 대해 이야기하기 전에 사용할 용어들에 대한 정의를 먼저 진행한다.

**가용성**
- 정의한 시간 내에 시스템이 살아있을 확률을 나타낸 것
- 시스템은 여러가지 장애로 인해 다운될 수 있다
  - 소프트웨어 에러
  - 네트워크 **이슈**
  - 로드 이슈
  - DDoS
  - 인프라 하드웨어 이슈
**확장성**
- 시스템 리소스의 확장/축소 가능성
**회복성**
- 시스템 실패를 우아하게 다루고 빠르게 회복할 수 있는 정도
**데이터 관리**
- 확장성, 가용성, 보안, 회복성과 연관
- 애플리케이션 형태에 따라 다름
  - Heavy write, heavy read
  - time series
  - Data warehousing
- 데이터 일관성, 가용성, 저장소 및 저장 전략에 따라 다를 수 있음
**성능**
**보안**
- 데이터 무결성, 내구성

## 1. CQRS(Command Query Responsibility Segregation): Write와 Read를 분리

- 확장성 및 성능 관점
- 이벤트 소싱 아키텍처와 잘 맞음
  - 이벤트를 받아 Write DB에 기록
  - Display, Report 목적으로 Read DB 사용
  - 정규화된 RDBMS에 쓰고 NoSQL로 읽기 사용
- 비동기 프로세스에 적합
- DB를 독립적으로 확장할 수 있다는 장점 보유

## 2. Anti Corruption Layer(부패 방지 레이어)

- 데이터 관리, 보안
- 레거시 시스템과 최신 시스템이 존재하고 최신 시스템으로 마이그레이션 할 때 사용
- 최신 시스템의 요청을 레거시로 변환하는 기능 포함

## 3. Circuit breaker(회로 차단기)

- 회복성, 내결함성
- 오류가 있을 경우에 예외적으로 발생시키는 패턴
- 닫힘, 열림, 반열림 상태 존재
  - 닫힘: 일반적인 상태
  - 열림: 애플리케이션이 의도한 바로 동작하지 않아 예외 기능을 발생시켜야 할 경우 사용
  - 반열림: 문제가 여전히 존재하는지 확인하기 위해 대기 시간을 부여하고 성공하면 닫힘 상태로 전환. 실패하면 열림 상태로 전환.

## 4. Event sourcing(이벤트 소싱)

- 확장성, 회복성, 성능
- 애플리케이션에서 이벤트를 전달 받았을 때 특정 기능들을 수행하는 패턴
- 행동의 상태뿐만 아니라 전체를 저장하기도 함

## 5. Pub/Sub

- 확장성, 회복성, 내결함성, 성능
- 클라우드 기반 시스템에서 한 시스템의 모듈은 모두 동일하거나 다른 시스템의 모듈과 비동기적으로 통신해야 함
- Message publisher, broker, subscriber 구조
  - Publisher: 메시지 발행
  - Broker: 메시지 보관 및 다중화, Subscriber에게 전달, Replay 등
  - Subscriber: 메시지 접수 및 로직 실행

## 6. Sharding(샤딩)

- 확장성, 데이터 관리 및 성능
- 데이터를 여러 샤드(조각)으로 나누는 패턴
- 데이터 확장성, 성능, 내결함성 향상
- 샤딩 전략
  - Range sharding
  - Vertical sharding: Data vertical partitioning 이라고도 함. 데이터를 레코드가 아닌 컬럼 기반으로 나눔
    - 고객의 트랜잭션 데이터와 고유 데이터를 분리하는 등
  - Hash sharding: modulo 연산으로 균등하게 분배하나 샤드가 증가할 때 리밸런싱의 문제가 있음
  - Consistent hashing: 

## 7. Strangler(교살자)

- 데이터 관리
- 모놀리식에서 마이크로 서비스로 마이그레이션 할 때 사용하는 패턴
  - 마이그레이션하는 시스템을 둘 다 사용하면서 다른 시스템과 사이에 파사드(Facade) 패턴을 사용

## 8. Saga

- 데이터 관리, 보안
- Command/Orchestration 패턴으로 설명
  - 여러 마이크로 서비스 중 하나의 마이크로 서비스에서 트랜잭션이 실패했을 경우로 가정
  - 모든 마이크로 서비스의 상태를 관리하는 중재자(Orchestratator)가 있어 하나의 트랜잭션이 실패했을 경우 모든 서비스를 롤백하도록 처리

## 9. Throttling

- 가용성, 탄력성
- Peak time 에 리소스를 추가 배치하는 패턴

## 10. Static content hosting

- 가용성, 성능
- 정적 컨텐츠를 사용자 가까이의 CND에 배포하는 패턴