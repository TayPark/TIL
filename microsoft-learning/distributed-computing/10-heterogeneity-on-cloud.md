# 클라우드에서 이질성

클라우드 데이터 센터는 컴퓨터, 네트워크, OS, 코드 라이브러리 및 프로그래밍 언어를 비롯한 다양한 구성 요소 컬렉션을 구성한다. 원칙적으로 **데이터 센터 구성 요소가 다양한 차이를 보일 경우 클라우드를 이기종 클라우드라고 한다.** 실제로 이질성은 주로 다음과 같은 이유 때문에 항상 유지되지 못한다.

- 클라우드 프로바이더는 **일반적으로 여러 시간 프레임에 걸쳐 구매한 IT 리소스의 여러 세대를 유지 관리**한다.
- 클라우드 프로바이더는 서버를 통합하고 시스템 사용률을 향상시키고 관리를 간소화하기 위해 **클라우드에 가상화 기술을 점점 더 많이 적용**하고 있다. 퍼블릭 클라우드는 주로 가상화된 데이터 센터이다. 프라이빗 클라우드의 경우에도 가상화 환경이 표준이 될 것으로 예상한다.

이질성은 가상화된 환경의 직접적인 결과이며 유사한 물리적 컴퓨터에 VM을 함께 배치하게 되면서 이질성이 야기될 수 있다. 예를 들어 두 개의 컴퓨터 A, B가 있고 A에는 1개의 VM, B에는 10개의 VM을 배치한다면 B가 더 높은 스트레스를 겪게될 것이다. 클라우드에서 하나의 컴퓨터에 더 많은 VM을 배치하려 할 것이고, 이는 훨씬 더 많은 이질성이 나타날 것이다.

이질성은 분산 프로그램을 실행할 때 여러 문제를 발생시킨다. 분산 프로그램은 기본 하드웨어, 네트워크, OS 및 프로그래밍 언어의 이질성을 마스킹하도록 디자인되어야 한다. 동질성이 유지된다는 환상은 태스크가 통신할 수 있도록 하며, 그렇지 않다면 메세지 전달 및 전체 분산 프로그램 개념이 실패한 것이다. 

데이터 문제도 고려해야 한다. 태스크 간 교환되는 메세지에는 일반적으로 같은 원시 데이터 형식이 포함되지만 모든 컴퓨터가 같은 형식으로 데이터를 표현하지 않는다. 예를들어 big-endian과 little-endian이 있다.

또한 부동소수점 숫자는 컴퓨터 아키텍처마다 다를 수 있다. 사용되는 코드 세트도 다를 수 있다. ASCII가 기본인 곳과 UTF-8이 기본인 곳이 있다. 이처럼 분산 프로그램은 이러한 이질성이 존재하도록 해야한다.

이질성을 해결하기 위해 분산 프로그램에 연결될 수 있는 부분을 일반적으로 미들웨어라고 한다. 대부분의 미들웨어는 인터넷 프로토콜을 통해 구현되며, 인터넷 프로토콜은 기본 네트워크의 차이점을 마스킹(추상화)한다.

일반적으로 한 컴퓨터에 적합한 코드가 클라우드에 다른 컴퓨터에서는 적합하지 않을 수 있다. ISA가 컴퓨터마다 다른 경우에는 특히 그렇다. 그러지만 이질성을 유도하는 가상화 기술이 문제 해결에 효과적으로 사용될 수 있다. 가상화 하이퍼바이저는 프로비저닝된 VM의 ISA와 기본 물리적 컴퓨터 간 차이를 에뮬레이팅하기 때문이다. 마지막으로 사용자는 항상 시스템 VM에 고유한 OS 및 라이브러리를 설치하여 OS 및 라이브러리 수준에서 동질성을 보장할 수 있다.

분산 프로그래머의 주의가 필요한 다른 문제는 클라우드의 성능 차이이다. 예를 들어, **동일한 프라이빗 클러스터에 있는 동일한 애뮬레이션에 대해 성능이 5배까지 달라질 수 있다.** 성능 차이는 주로 **가상화 환경으로 인한 클라우드의 이질성, 시간에 따른 리소스 수요 급증 및 감소로 인해 발생**한다. 결과적으로 클라우드 VM이 동일한 속도로 작업을 진행하는 경우는 거의 없으므로 태스크가 일정한 속도로 진행될 수 없다. 분산 프로그램은 느린 태스크를 감지하고 빠른 VM에 예측되는 해당 태스크를 예약하여 이러한 예측 태스크가 더 일찍 완료될 수 있도록 할 수 있지만, 이는 매우 어려운 일이며, 특히 클라우드에서는 더 그렇다. 태스크를 실행하는 특정 VM에서 일시적으로 수요가 크기 증가하거나 VM 자체에 결함이 있을 수도 있기 때문이다.