# 배달의 민족 DB IDC 탈출기

## 1. 장애 확산 탈출

초기에는 고성능 DB 1개로 사용하고 있었다. 만약 한 서비스가 DB에 부하를 주는 쿼리를 날리면 이는 다른 서비스들이 DB를 사용하지 못하게 되고, DB를 사용하지 못하니 서비스도 장애가 생기게된다.

## 2. 트래픽 증가 대응 불가

## 3. 신규 서비스 개발 속도 저하

서비스 복잡도가 증가할수록 개발자에게 부담이 더해지며, 서비스 요구사항이 증가함에 따라 개발 속도가 저하됨

## 무중단 마이그레이션
- 마이그레이션 범위가 넓은 경우
- 서비스 중단이 불가능 한 경우

**특징**
- 마이그레이션 중 지속적인 데이터 변경 발생
- Validation을 위한 충분한 시간 필요
- Master-Standby 구조로 마이그레이션 이후 이슈 발생 시 빠른 롤백 가능

**순서**
1. 특정 시점 데이터 마이그레이션
2. 데이터 동시 적재
  - 데이터 일치 여부 지속적 확인 필요
  - Source DB를 마스터로 사용
3. TargetDB를 충분히 테스트 후 마스터로 변경
  - 데이터 완전 일치 시점에 커넥션 전환
  - 롤백을 대비하여 기존 SourceDB와 연결 유지
4. SourceDB 커넥션 제거

## 빠른 마이그레이션
- 서비스 운영 시간이 제한되어 있는 경우
- 내부 운영을 위해서 사용되는 경우

**특징**
- 서비스 중단으로 데이터 변경 방지
- 중단이 가능하므로 추가 데이터 검증 과정 생략 가능

## 서비스 개선
- 아키텍처 최적화
- 런칭 시간 단축
- 장애 확산 방지

## DB 운영 개선
- 서비스 단위 성능 최적화
- 강화된 모니터링

